["956d53914a6287d573990acd550b2e7580f4aff4","f415681565177d39af7b013aa432686c51709445",["./NavigationStateUtils"],[51],{"version":3,"sources":["/var/www/geruapp/node_modules/react-native-experimental-navigation/NavigationStackReducer.js"],"names":["NavigationStateUtils","require","defaultGetReducerForState","initialState","state","NavigationStackReducer","getReducerForState","getPushedReducerForAction","getReducerForStateWithDefault","lastState","action","lastParentState","getParent","activeSubState","children","index","activeSubReducer","nextActiveState","nextChildren","subReducerToPush","push","type","length","pop","module","exports"],"mappings":";AAWA;;AAEA,IAAIA,uBAAuBC,QAAQ,wBAAR,CAA3B;;AAkDA,IAAMC,4BAA4B,SAA5BA,yBAA4B,CAACC,YAAD;AAAA,SAAkB,UAACC,KAAD;AAAA,WAAWA,SAASD,YAApB;AAAA,GAAlB;AAAA,CAAlC;;AAEA,SAASE,sBAAT,OAAsI;AAAA,MAArGF,YAAqG,QAArGA,YAAqG;AAAA,MAAvFG,kBAAuF,QAAvFA,kBAAuF;AAAA,MAAnEC,yBAAmE,QAAnEA,yBAAmE;;AACpI,MAAMC,gCAAgCF,sBAAsBJ,yBAA5D;AACA,SAAO,UAAUO,SAAV,EAAuCC,MAAvC,EAAqE;AAC1E,QAAI,CAACD,SAAL,EAAgB;AACd,aAAON,YAAP;AACD;AACD,QAAMQ,kBAAkBX,qBAAqBY,SAArB,CAA+BH,SAA/B,CAAxB;AACA,QAAI,CAACE,eAAL,EAAsB;AACpB,aAAOF,SAAP;AACD;;AAED,QAAMI,iBAAiBF,gBAAgBG,QAAhB,CAAyBH,gBAAgBI,KAAzC,CAAvB;AACA,QAAMC,mBAAmBR,8BAA8BK,cAA9B,CAAzB;AACA,QAAMI,kBAAkBD,iBAAiBH,cAAjB,EAAiCH,MAAjC,CAAxB;AACA,QAAIO,oBAAoBJ,cAAxB,EAAwC;AACtC,UAAMK,wDAAmBP,gBAAgBG,QAAnC,EAAN;AACAI,mBAAaP,gBAAgBI,KAA7B,IAAsCE,eAAtC;AACA,sCACKN,eADL;AAEEG,kBAAUI;AAFZ;AAID;;AAED,QAAMC,mBAAmBZ,0BAA0BG,MAA1B,EAAkCC,eAAlC,CAAzB;AACA,QAAIQ,gBAAJ,EAAsB;AACpB,aAAOnB,qBAAqBoB,IAArB,CACLT,eADK,EAELQ,iBAAiB,IAAjB,EAAuBT,MAAvB,CAFK,CAAP;AAID;;AAED,YAAQA,OAAOW,IAAf;AACE,WAAK,MAAL;AACA,WAAK,YAAL;AACE,YAAIV,gBAAgBI,KAAhB,KAA0B,CAA1B,IAA+BJ,gBAAgBG,QAAhB,CAAyBQ,MAAzB,KAAoC,CAAvE,EAA0E;AACxE,iBAAOX,eAAP;AACD;AACD,eAAOX,qBAAqBuB,GAArB,CAAyBZ,eAAzB,CAAP;AANJ;;AASA,WAAOA,eAAP;AACD,GAvCD;AAwCD;;AAEDa,OAAOC,OAAP,GAAiBpB,sBAAjB","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule NavigationStackReducer\n * @flow\n */\n'use strict';\n\nvar NavigationStateUtils = require('./NavigationStateUtils');\n\nimport type {\n  NavigationState,\n  NavigationParentState,\n  NavigationReducer,\n} from 'NavigationTypeDefinition';\n\nimport type {\n  BackAction,\n} from 'NavigationRootContainer';\n\nexport type NavigationStackReducerAction = BackAction | {\n  type: string,\n};\n\nexport type ReducerForStateHandler = (state: NavigationState) => NavigationReducer;\n\nexport type PushedReducerForActionHandler = (action: any, lastState: NavigationParentState) => ?NavigationReducer;\n\nexport type StackReducerConfig = {\n  /*\n   * The initialState is that the reducer will use when there is no previous state.\n   * Must be a NavigationParentState:\n   *\n   * {\n   *   children: [\n   *     {key: 'subState0'},\n   *     {key: 'subState1'},\n   *   ],\n   *   index: 0,\n   *   key: 'navStackKey'\n   * }\n   */\n  initialState: NavigationParentState;\n\n  /*\n   * Returns the sub-reducer for a particular state to handle. This will be called\n   * when we need to handle an action on a sub-state. If no reducer is returned,\n   * no action will be taken\n   */\n  getReducerForState?: ReducerForStateHandler;\n\n  /*\n   * Returns a sub-reducer that will be used when pushing a new route. If a reducer\n   * is returned, it be called to get the new state that will be pushed\n   */\n  getPushedReducerForAction: PushedReducerForActionHandler;\n};\n\nconst defaultGetReducerForState = (initialState) => (state) => state || initialState;\n\nfunction NavigationStackReducer({initialState, getReducerForState, getPushedReducerForAction}: StackReducerConfig): NavigationReducer {\n  const getReducerForStateWithDefault = getReducerForState || defaultGetReducerForState;\n  return function (lastState: ?NavigationState, action: any): NavigationState {\n    if (!lastState) {\n      return initialState;\n    }\n    const lastParentState = NavigationStateUtils.getParent(lastState);\n    if (!lastParentState) {\n      return lastState;\n    }\n\n    const activeSubState = lastParentState.children[lastParentState.index];\n    const activeSubReducer = getReducerForStateWithDefault(activeSubState);\n    const nextActiveState = activeSubReducer(activeSubState, action);\n    if (nextActiveState !== activeSubState) {\n      const nextChildren = [...lastParentState.children];\n      nextChildren[lastParentState.index] = nextActiveState;\n      return {\n        ...lastParentState,\n        children: nextChildren,\n      };\n    }\n\n    const subReducerToPush = getPushedReducerForAction(action, lastParentState);\n    if (subReducerToPush) {\n      return NavigationStateUtils.push(\n        lastParentState,\n        subReducerToPush(null, action)\n      );\n    }\n\n    switch (action.type) {\n      case 'back':\n      case 'BackAction':\n        if (lastParentState.index === 0 || lastParentState.children.length === 1) {\n          return lastParentState;\n        }\n        return NavigationStateUtils.pop(lastParentState);\n    }\n\n    return lastParentState;\n  };\n}\n\nmodule.exports = NavigationStackReducer;\n"]}]