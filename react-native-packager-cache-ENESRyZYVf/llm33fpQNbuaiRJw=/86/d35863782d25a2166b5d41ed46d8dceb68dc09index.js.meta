["cfaf1b4d8d5cc7ed23efc249314efb9a78754ee5","8313f64a8bbc9e9ada42d136816b6b534a963cca",["react","react-native"],[87,184],{"version":3,"sources":["/var/www/geruapp/src/components/react-native-radial-menu/index.js"],"names":["generateRadialPositions","count","radius","spread_angle","start_angle","span","start","Math","PI","rad","Array","map","_","i","x","cos","y","sin","RadialMenu","props","childrenToArray","bind","itemPanListener","releaseItem","createPanResponder","computeNewSelected","children","initial_spots","length","menuRadius","spreadAngle","startAngle","unshift","state","item_spots","item_anims","ValueXY","selectedItem","itemPanResponder","RMOpening","setState","Children","forEach","child","push","e","gestureState","newSelected","restSpot","spring","toValue","onClose","onSelect","item","tension","friction","create","onStartShouldSetPanResponder","onPanResponderGrant","onOpen","stagger","spot","idx","setTimeout","onPanResponderMove","event","dx","dy","listener","onPanResponderRelease","onPanResponderTerminate","minDist","Infinity","pointRadius","sqrt","abs","delta","dist","styles","menuContainer","width","itemRadius","height","style","j","handlers","panHandlers","transform","getTranslateTransform","menuItem","position","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Animated, PanResponder, StyleSheet, View } from 'react-native';\n\nconst generateRadialPositions = (count, radius, spread_angle, start_angle) => {\n\tlet span = spread_angle < 360 ? 1 : 0;\n  let start = start_angle * Math.PI / 180;\n  let rad = spread_angle * Math.PI * 2 / 360 / (count - span);\n  return [...Array(count)].map((_, i) => {\n    return {\n      x: -Math.cos(start + rad * i) * radius,\n      y: -Math.sin(start + rad * i) * radius,\n    };\n  });\n};\n\nexport default class RadialMenu extends Component {\n  constructor(props) {\n    super(props);\n    this.childrenToArray = this.childrenToArray.bind(this);\n    this.itemPanListener = this.itemPanListener.bind(this);\n    this.releaseItem = this.releaseItem.bind(this);\n    this.createPanResponder = this.createPanResponder.bind(this);\n    this.computeNewSelected = this.computeNewSelected.bind(this);\n\n    let children = this.childrenToArray();\n    let initial_spots = generateRadialPositions(\n      children.length - 1,\n      this.props.menuRadius,\n      this.props.spreadAngle,\n      this.props.startAngle\n    );\n\t\tinitial_spots.unshift({x: 0, y: 0});\n    this.state = {\n      item_spots: initial_spots,\n      item_anims: initial_spots.map((_, i) => {\n        return new Animated.ValueXY();\n      }),\n      selectedItem: null,\n      itemPanResponder: null,\n      children: children,\n    };\n\n    this.RMOpening = false;\n  }\n\n  componentWillMount() {\n    this.setState({ itemPanResponder: this.createPanResponder() });\n  }\n\n  // React.Children.toArray is still not exposed on RN 0.20.0-rc1\n  childrenToArray() {\n    let children = [];\n    React.Children.forEach(this.props.children, (child) => {\n      children.push(child)\n    });\n    return children;\n  }\n\n  itemPanListener(e, gestureState) {\n    let newSelected = null;\n    if (!this.RMOpening) {\n      newSelected = this.computeNewSelected(gestureState);\n      if (this.state.selectedItem !== newSelected) {\n        if (this.state.selectedItem !== null) {\n          let restSpot = this.state.item_spots[this.state.selectedItem];\n          Animated.spring(this.state.item_anims[this.state.selectedItem], {\n            toValue: restSpot,\n          }).start();\n        }\n        if (newSelected !== null && newSelected !== 0) {\n          Animated.spring(this.state.item_anims[newSelected], {\n            toValue: this.state.item_anims[0],\n          }).start();\n        }\n        this.state.selectedItem = newSelected;\n      }\n    }\n  }\n\n  releaseItem() {\n    this.props.onClose && this.props.onClose();\n\n    this.state.selectedItem && !this.RMOpening &&\n    this.state.children[this.state.selectedItem].props.onSelect &&\n    this.state.children[this.state.selectedItem].props.onSelect();\n\n    this.state.selectedItem = null;\n\n    this.state.item_anims.forEach((item, i) => {\n      Animated.spring(item, {\n        toValue: {x: 0, y: 0},\n        tension: 60,\n        friction: 10\n      }).start();\n    });\n  }\n\n  createPanResponder() {\n    return PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onPanResponderGrant: () => {\n        this.props.onOpen && this.props.onOpen();\n        this.RMOpening = true;\n        Animated.stagger(40,\n          this.state.item_spots.map((spot, idx) =>\n            Animated.spring(this.state.item_anims[idx], {\n              toValue: spot,\n              friction: 6,\n              tension: 80\n            })\n          )\n        ).start();\n        // Make sure all items gets to innitial position\n        // before we start tracking them\n        setTimeout(() => {this.RMOpening = false}, 500);\n      },\n      onPanResponderMove: Animated.event(\n        [ null, {dx: this.state.item_anims[0].x, dy: this.state.item_anims[0].y} ],\n        {listener: this.itemPanListener}\n      ),\n      onPanResponderRelease: this.releaseItem,\n      onPanResponderTerminate: this.releaseItem,\n    });\n  }\n\n  computeNewSelected(gestureState) {\n    let {dx, dy} = gestureState;\n    let minDist = Infinity;\n    let newSelected = null;\n    let pointRadius = Math.sqrt(dx * dx + dy * dy);\n    if (Math.abs(this.props.menuRadius - pointRadius) < this.props.menuRadius / 2) {\n      this.state.item_spots.forEach((spot, idx) => {\n        let delta = {x: spot.x - dx, y: spot.y - dy};\n        let dist = delta.x * delta.x + delta.y * delta.y;\n        if (dist < minDist) {\n          minDist = dist;\n          newSelected = idx;\n        }\n      });\n    }\n    return newSelected;\n  }\n\n\n  render() {\n    return (\n      <View style={[styles.menuContainer,\n        { \n          width: this.props.itemRadius * 2,\n          height: this.props.itemRadius * 2,\n        },\n        this.props.style]}>\n\n        {this.state.item_anims.map((_, i) => {\n          let j = this.state.item_anims.length - i - 1;\n          let handlers = j > 0 ? {} : this.state.itemPanResponder.panHandlers;\n          return (\n            <Animated.View\n              {...handlers}\n              key={i}\n              style={[{\n                transform: this.state.item_anims[j].getTranslateTransform(),\n              }, styles.menuItem]} >\n              {this.state.children[j]}\n            </Animated.View>\n          );\n        })}\n      </View>\n    );\n  }\n}\n\nvar styles = StyleSheet.create({\n    menuContainer: {\n        position: 'relative',\n        //backgroundColor: 'transparent',\n    },\n\n    menuItem: {\n        position: 'absolute',\n    }\n})\n\nRadialMenu.defaultProps = {\n  itemRadius: 30,\n  menuRadius: 100,\n  spreadAngle: 360,\n  startAngle: 0\n};\n"]}]