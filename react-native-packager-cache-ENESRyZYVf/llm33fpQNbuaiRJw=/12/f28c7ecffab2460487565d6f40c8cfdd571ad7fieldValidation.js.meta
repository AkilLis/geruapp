["b01e8ed054805058f29bb27167669f92e3ddeb53","775a67299510804c38c909a810bdf3e3f3186680",["validate.js","underscore"],[141,249],{"version":3,"sources":["/var/www/geruapp/src/components/fieldValidation.js"],"names":["fieldValidation","emailConstraints","from","email","usernamePattern","usernameConstraints","username","format","pattern","flags","titlePattern","titleConstraints","title","descriptionPattern","descriptionConstraints","description","passwordPattern","passwordConstraints","password","passwordAgainConstraints","confirmPassword","equality","state","action","payload","field","value","validTitle","isUndefined","setIn","validDesc","validUsername","validEmail","validPassword","validPasswordAgain","form","fields"],"mappings":"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","sourcesContent":["/**\n * # fieldValidation.js\n *\n * Define the validation rules for various fields such as email, username,\n * and passwords.  If the rules are not passed, the appropriate\n * message is displayed to the user\n *\n */\n'use strict'\n\n/**\n * ## Imports\n *\n * validate and underscore\n *\n */\nimport validate from 'validate.js'\nimport _ from 'underscore'\n/**\n * ### Translations\n */\n/**\n * ## Email validation setup\n * Used for validation of emails\n */\nconst emailConstraints = {\n  from: {\n    email: true\n  }\n}\n\n/**\n* ## username validation rule\n* read the message.. ;)\n*/\nconst usernamePattern = /^[a-zA-Z0-9]{6,12}$/\nconst usernameConstraints = {\n  username: {\n    format: {\n      pattern: usernamePattern,\n      flags: 'i'\n    }\n  }\n}\n\nconst titlePattern = /^.{6,30}$/\nconst titleConstraints = {\n  title: {\n    format: {\n      pattern: titlePattern,\n      flags: 'i'\n    }\n  }\n}\n\nconst descriptionPattern = /^.{10,300}$/\nconst descriptionConstraints = {\n  description: {\n    format: {\n      pattern: descriptionPattern,\n      flags: 'i'\n    }\n  }\n}\n\n/**\n* ## password validation rule\n* read the message... ;)\n*/\nconst passwordPattern = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,12}$/\nconst passwordConstraints = {\n  password: {\n    format: {\n      pattern: passwordPattern,\n      flags: 'i'\n    }\n  }\n}\n\nconst passwordAgainConstraints = {\n  confirmPassword: {\n    equality: 'password'\n  }\n}\n\n/**\n * ## Field Validation\n * @param {Object} state Redux state\n * @param {Object} action type & payload\n */\nexport default function fieldValidation (state, action) {\n  const {field, value} = action.payload\n\n  switch (field) {\n    /**\n     * ### username validation\n     * set the form field error\n     */\n    case ('title'): {\n       let validTitle = _.isUndefined(validate({title: value}, titleConstraints))\n\n       if (validTitle) {\n        return state.setIn(['form', 'fields', 'titleHasError'],\n                         false)\n        .setIn(['form', 'fields', 'titleErrorMsg'], '')\n      } else {\n        return state.setIn(['form', 'fields', 'titleHasError'], true)\n        .setIn(['form', 'fields', 'titleErrorMsg'], 'Гарчиг нь 6-30 тэмдэгтийн урттай байна.')\n      }\n    }\n\n    case ('description') : {\n      let validDesc = _.isUndefined(validate({description: value}, descriptionConstraints))\n\n      if (validDesc) {\n        return state.setIn(['form', 'fields', 'descriptionHasError'],\n                         false)\n        .setIn(['form', 'fields', 'descriptionErrorMsg'], '')\n      } else {\n        return state.setIn(['form', 'fields', 'descriptionHasError'], true)\n        .setIn(['form', 'fields', 'descriptionErrorMsg'], 'Тайлбар нь 10-300 тэмдэгтийн урттай байна.')\n      }\n    }\n\n    case ('username'): {\n      let validUsername = _.isUndefined(validate({username: value},\n                                                usernameConstraints))\n      if (validUsername) {\n        return state.setIn(['form', 'fields', 'usernameHasError'],\n                         false)\n        .setIn(['form', 'fields', 'usernameErrorMsg'], '')\n      } else {\n        return state.setIn(['form', 'fields', 'usernameHasError'], true)\n        .setIn(['form', 'fields', 'usernameErrorMsg'], '6-12 in length with letters or numbers')\n      }\n    }\n\n    /**\n     * ### email validation\n     * set the form field error\n     */\n    case ('email'): {\n      let validEmail = _.isUndefined(validate({from: value},\n                                             emailConstraints))\n      if (validEmail) {\n        return state.setIn(['form', 'fields', 'emailHasError'], false)\n      } else {\n        return state.setIn(['form', 'fields', 'emailHasError'], true)\n        .setIn(['form', 'fields', 'emailErrorMsg'],\n                 'not valid email')\n      }\n    }\n\n    /**\n     * ### password validation\n     * set the form field error\n     */\n    case ('password'): {\n      let validPassword = _.isUndefined(validate({password: value},\n                                               passwordConstraints))\n      if (validPassword) {\n        return state.setIn(['form', 'fields', 'passwordHasError'],\n                         false)\n        .setIn(['form', 'fields', 'passwordErrorMsg'],\n               '')\n      } else {\n        return state.setIn(['form', 'fields', 'passwordHasError'], true)\n        .setIn(['form', 'fields', 'passwordErrorMsg'],\n          'Not valid passpord')\n      }\n    }\n\n    /**\n     * ### passwordAgain validation\n     * set the form field error\n     */\n    case ('passwordAgain'):\n      var validPasswordAgain =\n          _.isUndefined(validate({password: state.form.fields.password,\n                                confirmPassword: value}, passwordAgainConstraints))\n      if (validPasswordAgain) {\n        return state.setIn(['form', 'fields', 'passwordAgainHasError'],\n                         false)\n        .setIn(['form', 'fields', 'passwordAgainErrorMsg'], '')\n      } else {\n        return state.setIn(['form', 'fields', 'passwordAgainHasError'],\n                          true)\n        .setIn(['form', 'fields', 'passwordAgainErrorMsg'],\n        'dahial buruu pass')\n      }\n\n    /**\n     * ### showPassword\n     * toggle the display of the password\n     */\n    case ('showPassword'):\n      return state.setIn(['form', 'fields',\n                                'showPassword'], value)\n\n  }\n  return state\n}\n"]}]